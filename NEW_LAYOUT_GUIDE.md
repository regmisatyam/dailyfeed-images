# ğŸ¨ New Image Layout Guide

## Visual Comparison

### Old Layout (v1.0.0)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       1920 Ã— 1080                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•—                                              â”‚
â”‚  â•‘           â•‘         BACKGROUND IMAGE                     â”‚
â”‚  â•‘   MAIN    â•‘       (Darkened to 70%)                      â”‚
â”‚  â•‘  SUBJECT  â•‘                                              â”‚
â”‚  â•‘           â•‘              â•”â•â•â•â•â•â•â•â•â•â•â•â•—                   â”‚
â”‚  â•‘  (Left)   â•‘              â•‘ SECONDARY â•‘                   â”‚
â”‚  â•‘           â•‘              â•‘  SUBJECT  â•‘                   â”‚
â”‚  â•‘           â•‘              â•‘  (Right)  â•‘                   â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•              â•šâ•â•â•â•â•â•â•â•â•â•â•â•                   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Trump and Oil Prices Shake Global Markets and Cau...â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘ Title truncated at 100 chars, left-aligned
```

### New Layout (v1.1.0) âœ¨
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       1920 Ã— 1080                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚              MAIN SUBJECT PHOTO                             â”‚
â”‚            (Full background coverage)                        â”‚
â”‚            (Darkened to 60-65%)                             â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚    Trump and Oil Prices Shake Global Markets and    â”‚   â”‚
â”‚  â”‚   Cause Widespread Economic Uncertainty Across      â”‚   â”‚
â”‚  â”‚              Europe and Asia                         â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘ Full title with word wrapping, centered
```

## Key Improvements

### 1. Title Display

#### Before âŒ
- Truncated at 100 characters
- Ellipsis (...) for long titles
- Information loss
- Left-aligned

#### After âœ…
- **Full title displayed**
- Word wrapping (60 chars/line)
- All information visible
- **Center-aligned**

### 2. Image Focus

#### Before âŒ
- Complex multi-layer composition
- Background + overlays
- Main subject less prominent
- Cluttered appearance

#### After âœ…
- **Main subject as primary focus**
- Single focused image
- Clear visual hierarchy
- **Clean, professional look**

### 3. Text Positioning

#### Before âŒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Title starts here... â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### After âœ…
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Title centered    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Technical Specifications

### Text Rendering

```javascript
// Word Wrapping
Max characters per line: 60
Line height: 60px
Font size: 48px
Font: Arial Bold
Color: White (#ffffff)
Alignment: Center (text-anchor: middle)
```

### Overlay Specs

```javascript
// Dynamic Height
Minimum height: 200px
Line estimation: title.length / 60
Height calculation: lines Ã— 60px + 80px padding
Background: Black with 75% opacity
```

### Image Composition

```javascript
// Canvas
Size: 1920 Ã— 1080 (16:9)
Format: JPEG
Quality: 90%

// Main Subject
Coverage: Full canvas (100%)
Brightness: 60-65%
Fit: Cover (no distortion)
Position: Center
```

## Examples with Real Titles

### Example 1: Short Title
**Title:** "Biden Announces New Policy"

**Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚                  BIDEN PHOTO (FULL)                         â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚            Biden Announces New Policy                â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        Single line, plenty of padding
```

### Example 2: Medium Title
**Title:** "Trump and Oil Prices Shake Global Markets and Cause Widespread Economic Uncertainty"

**Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚                  TRUMP PHOTO (FULL)                         â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚    Trump and Oil Prices Shake Global Markets and    â”‚   â”‚
â”‚  â”‚   Cause Widespread Economic Uncertainty              â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        Two lines, word-wrapped at boundaries
```

### Example 3: Long Title
**Title:** "President Biden Delivers Historic Speech on Climate Change Initiative That Will Transform American Energy Policy and Create Millions of Green Jobs Over the Next Decade"

**Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚                  BIDEN PHOTO (FULL)                         â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ President Biden Delivers Historic Speech on Climate â”‚   â”‚
â”‚  â”‚ Change Initiative That Will Transform American      â”‚   â”‚
â”‚  â”‚ Energy Policy and Create Millions of Green Jobs     â”‚   â”‚
â”‚  â”‚ Over the Next Decade                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        Four lines, overlay expanded automatically
```

## Subject Focus Strategy

### Priority: Main Subject First

1. **If person identified** â†’ Person photo fills canvas
2. **If object identified** â†’ Object photo fills canvas
3. **If location identified** â†’ Location photo fills canvas
4. **Fallback** â†’ First relevant photo fills canvas

### Why This Works

âœ… **Clear focus** - One primary subject, not competing elements  
âœ… **News-style** - Similar to professional news graphics  
âœ… **Readable** - No visual clutter around text  
âœ… **Impactful** - Strong visual presence  

## Word Wrapping Algorithm

```javascript
// Pseudo-code
maxCharsPerLine = 60
words = title.split(' ')
lines = []
currentLine = ''

for each word in words:
  if (currentLine + word).length <= maxCharsPerLine:
    currentLine += word + ' '
  else:
    lines.push(currentLine)
    currentLine = word + ' '

lines.push(currentLine)
```

**Features:**
- Respects word boundaries (no mid-word breaks)
- Maintains natural reading flow
- Automatic line distribution
- Handles titles of any length

## Dynamic Overlay Height

```javascript
// Calculation
charsPerLine = 60
estimatedLines = Math.ceil(title.length / charsPerLine)
lineHeight = 60
padding = 80
overlayHeight = Math.max(200, estimatedLines Ã— lineHeight + padding)
```

**Examples:**
- 50 chars â†’ 1 line â†’ 200px (minimum)
- 100 chars â†’ 2 lines â†’ 200px (fits in minimum)
- 150 chars â†’ 3 lines â†’ 260px (expanded)
- 300 chars â†’ 5 lines â†’ 380px (expanded further)

## Testing Checklist

### Visual Tests
- [ ] Title is fully visible (no truncation)
- [ ] Text is centered horizontally
- [ ] Text is centered within overlay
- [ ] Word wrapping looks natural
- [ ] No mid-word breaks
- [ ] Adequate padding around text

### Subject Focus Tests
- [ ] Main subject fills entire canvas
- [ ] Subject is clearly identifiable
- [ ] Image quality is good
- [ ] Brightness allows text readability
- [ ] No unnecessary secondary images

### Readability Tests
- [ ] Text is easy to read
- [ ] Good contrast with background
- [ ] Font size is appropriate
- [ ] Line spacing is comfortable
- [ ] Overlay is not too dark/light

## How to Test

### Step 1: Clear Cache
```bash
rm public/generated/*.jpg
```

### Step 2: Generate New Image
```bash
npm start
# In another terminal:
curl "http://localhost:3000/news-image?id=393"
```

### Step 3: View Result
```bash
open public/generated/news_393.jpg
```

### Step 4: Check Against Checklist
- Is the title complete?
- Is it centered?
- Does word wrapping look good?
- Is the main subject clear?

## Customization Options

### Change Font Size
Edit `src/services/imageComposer.js`:
```javascript
const fontSize = 48; // Change this value
```

### Change Line Width
```javascript
const maxCharsPerLine = 60; // Adjust characters per line
```

### Change Overlay Opacity
```javascript
background: { r: 0, g: 0, b: 0, alpha: 0.75 } // Change alpha (0-1)
```

### Change Image Brightness
```javascript
.modulate({ brightness: 0.6 }) // Change brightness (0-1)
```

## Troubleshooting

### Title is cut off
**Cause:** Very long single word  
**Solution:** Word will wrap to next line automatically

### Text is too small
**Cause:** Font size might be too small for screen  
**Solution:** Increase `fontSize` in `createTextSvg()`

### Overlay is too tall
**Cause:** Very long title  
**Solution:** This is expected; overlay expands to fit

### Can't see main subject
**Cause:** Image might be too dark  
**Solution:** Increase `brightness` value (closer to 1.0)

## Summary

### What Changed
âœ… Full titles (no truncation)  
âœ… Bottom-center positioning  
âœ… Main subject as primary focus  

### Why It's Better
âœ… More information visible  
âœ… Better visual balance  
âœ… Stronger subject focus  
âœ… Professional appearance  

### Impact
âœ… Zero breaking changes  
âœ… Same API  
âœ… Better output  

---

**Version:** 1.1.0  
**Updated:** January 19, 2026  
**Status:** âœ… Live

